"use strict";(self.webpackChunkmec_sim_calc_docs=self.webpackChunkmec_sim_calc_docs||[]).push([[2089],{3905:function(e,t,n){n.d(t,{Zo:function(){return s},kt:function(){return u}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var d=a.createContext({}),l=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},s=function(e){var t=l(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,d=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),m=l(n),u=i,h=m["".concat(d,".").concat(u)]||m[u]||c[u]||r;return n?a.createElement(h,o(o({ref:t},s),{},{components:n})):a.createElement(h,o({ref:t},s))}));function u(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=m;var p={};for(var d in t)hasOwnProperty.call(t,d)&&(p[d]=t[d]);p.originalType=e,p.mdxType="string"==typeof e?e:i,o[1]=p;for(var l=2;l<r;l++)o[l]=n[l];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},3497:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return d},metadata:function(){return l},toc:function(){return s},default:function(){return m}});var a=n(7462),i=n(3366),r=(n(7294),n(3905)),o=["components"],p={sidebar_label:"Overview",sidebar_position:1},d="Overview",l={unversionedId:"files/overview",id:"files/overview",title:"Overview",description:"File Input",source:"@site/docs/files/overview.md",sourceDirName:"files",slug:"/files/overview",permalink:"/files/overview",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"Overview",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"Tables",permalink:"/output/tables"},next:{title:"Text Files",permalink:"/files/text-files"}},s=[{value:"File Input",id:"file-input",children:[],level:2},{value:"Decoding File Data",id:"decoding-file-data",children:[],level:2},{value:"File Output",id:"file-output",children:[],level:2}],c={toc:s};function m(e){var t=e.components,n=(0,i.Z)(e,o);return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"overview"},"Overview"),(0,r.kt)("h2",{id:"file-input"},"File Input"),(0,r.kt)("p",null,"As described in the ",(0,r.kt)("a",{parentName:"p",href:"../inputs/input-types"},"input types page"),", the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"developer"))," can choose ",(0,r.kt)("inlineCode",{parentName:"p"},"FileInput")," when creating the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"app")),"'s inputs page, allowing the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"user"))," to upload files whose data can be used within the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"app")),". When a file is imported, its data will be available in the ",(0,r.kt)("strong",{parentName:"p"},"Code")," step as a ",(0,r.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/3538021"},"base64")," string, which is composed of the file data preceded by the file type and the encoding type. For example, the resulting string of imported CSV and PNG files have the following respective formats:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'"data:text/csv;base64,xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\n"data:image/png;base64,xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\n')),(0,r.kt)("p",null,"where ",(0,r.kt)("inlineCode",{parentName:"p"},"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx")," is the base64 string encoding of the ",(0,r.kt)("em",{parentName:"p"},"file data"),"."),(0,r.kt)("p",null,"As an example, the ",(0,r.kt)("a",{parentName:"p",href:"https://mecsimcalc.com/app/3705244/import_file"},"File Import ",(0,r.kt)("em",{parentName:"a"},(0,r.kt)("strong",{parentName:"em"},"app")))," imports a file and displays the the file type and the base64 encoded file data. Part of the Python code for this ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"app"))," is given below:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'def main(inputs):\n    [meta, data] = inputs[\'file\'].split(";base64,")\n    metadata = meta + ";base64,"\n\n    return {\n        "MetaData": metadata,\n        "Base64 String": data\n    }\n')),(0,r.kt)("p",null,"The two keys ",(0,r.kt)("inlineCode",{parentName:"p"},"MetaData")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Base64 String")," are then used in the output page to display their values:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'File Type: {{ outputs.MetaData }}\nBase64 String: {{ outputs["Base64 String"] }}\n')),(0,r.kt)("h2",{id:"decoding-file-data"},"Decoding File Data"),(0,r.kt)("p",null,"Once the file data is uploaded, the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"developer"))," can use the ",(0,r.kt)("inlineCode",{parentName:"p"},"base64")," Python library to decode and reconstruct a file-like object in order to manipulate the data. The ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/base64.html"},(0,r.kt)("inlineCode",{parentName:"a"},"base64.b64decode()"))," function can be used to decode the data into a ",(0,r.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/stdtypes.html#bytes"},(0,r.kt)("inlineCode",{parentName:"a"},"Bytes Object")),". As an example, the following code returns the file type, the base64 string representation of the data, and the decoded ",(0,r.kt)("inlineCode",{parentName:"p"},"Bytes")," data."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'import base64\n\ndef main(inputs):\n    # Decode the file data\n    [meta, data] = inputs[\'file\'].split(";base64,")\n    metadata = meta + ";base64,"\n    decodeddata = base64.b64decode(data)\n    return {\n        "MetaData": metadata,\n        "Base64 String": data,\n        "decoded String": decodeddata\n    }\n')),(0,r.kt)("h2",{id:"file-output"},"File Output"),(0,r.kt)("p",null,"In order to create and export a file for the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"user"))," to download, the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"developer"))," can use base64 encoding for data transfer. The function ",(0,r.kt)("inlineCode",{parentName:"p"},"base64.b64encode()")," converts the ",(0,r.kt)("inlineCode",{parentName:"p"},"Bytes")," data into base64 encoded bytes. Then, the ",(0,r.kt)("inlineCode",{parentName:"p"},".decode()")," method converts the base64 bytes into a string. The file type data should be added to the beginning of the encode data string and the resulting string can then be prepared for download using the ",(0,r.kt)("a",{parentName:"p",href:"https://www.w3schools.com/tags/tag_a.asp"},(0,r.kt)("inlineCode",{parentName:"a"},"<a>"))," HTML tag. The ",(0,r.kt)("inlineCode",{parentName:"p"},"href")," attribute of the ",(0,r.kt)("inlineCode",{parentName:"p"},"<a>")," is to be set to the file data string, while the ",(0,r.kt)("inlineCode",{parentName:"p"},"download")," attribute is set to the filename when the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"user"))," attempts to download the file."),(0,r.kt)("p",null,"The following code of the ",(0,r.kt)("a",{parentName:"p",href:"https://mecsimcalc.com/app/3705244/import_file"},"Import File")," ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"app"))," uses data obtained from a file uploaded by the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"user")),". The file extension is obtained using the ",(0,r.kt)("inlineCode",{parentName:"p"},"guess_extension")," from the ",(0,r.kt)("inlineCode",{parentName:"p"},"mimetypes")," library. The code creates two file data that are then available for download. The first file is prepared using the original data, while the second file is prepared by first decoding the original data and then encoding it again. The extension of the second file in the download link is set to ",(0,r.kt)("inlineCode",{parentName:"p"},".txt"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'from mimetypes import guess_extension, guess_type\nimport base64\n\ndef main(inputs):\n    # Split the file data into two components meta and data. The split function removes the string ";base64",\n    [meta, data] = inputs[\'file\'].split(";base64,")\n\n    # add ";base64" to meta\n    metadata = meta + ";base64,"\n    # recreate the original file data by concatenating metadata and data\n    OriginalFile = metadata + data\n\n    # create a byte_object by decoding the file data\n    byte_object = base64.b64decode(data)\n    # create a string of the decoded byte_object using the .decode() method.\n    decoded_string_object = 0 # byte_object.decode()\n    # using base64, the byte object can be encoded resulting in a byte object. The ".decode()" method returns the equivalent string.\n    base64_converted_string = base64.b64encode(byte_object).decode()\n    # creates a new file by concatenating metadata and the base64_converted_string\n    NewFile = metadata + base64_converted_string\n\n    # guess the extension from meta\n    file_extension1 = guess_extension(guess_type(metadata)[0])\n    # new file extension\n    file_extension2 = ".txt"\n\n    return {\n        "MetaData": metadata,\n        "Base64 String": data,\n        "decoded Bytes": byte_object,\n        "decoded String Object": decoded_string_object,\n        "Download Original": "<a href=\'" + OriginalFile + "\' download=\'Original" + file_extension1 + "\'>Download</a>",\n        "Download New": "<a href=\'" + NewFile + "\' download=\'New" + file_extension2 + "\'>Download</a>"\n    }\n')),(0,r.kt)("p",null,"Notice that the values of the ",(0,r.kt)("inlineCode",{parentName:"p"},"Download Original")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Download New")," are strings containing the ",(0,r.kt)("inlineCode",{parentName:"p"},"<a>")," HTML tag, which has ",(0,r.kt)("inlineCode",{parentName:"p"},"href")," set as the file data, and ",(0,r.kt)("inlineCode",{parentName:"p"},"download")," set as the downloaded filename. When the ",(0,r.kt)("em",{parentName:"p"},(0,r.kt)("strong",{parentName:"em"},"user"))," runs the app, the ",(0,r.kt)("inlineCode",{parentName:"p"},"<a>")," tag will become a hyperlink that will download the file when clicked."),(0,r.kt)("p",null,"The output editor has the following text:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'To download original file: {{ outputs["Download Original"] }}\nTo download new file (with extension .txt): {{ outputs["Download New"] }}\n\nFile Type: {{ outputs.MetaData }}\nBase64 String: {{ outputs["Base64 String"] }}\nDecoded Bytes Object: {{ outputs["decoded Bytes"] }}\n')))}m.isMDXComponent=!0}}]);