"use strict";(self.webpackChunkmec_sim_calc_docs=self.webpackChunkmec_sim_calc_docs||[]).push([[4809],{4125:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var n=t(5893),i=t(1151);const o={sidebar_label:"Quiz Toolkit",sidebar_position:1},r="Quiz Toolkit",l={id:"advanced-applications/quiz-toolkit",title:"Quiz Toolkit",description:"| This is a premium feature |",source:"@site/docs/advanced-applications/quiz-toolkit.md",sourceDirName:"advanced-applications",slug:"/advanced-applications/quiz-toolkit",permalink:"/advanced-applications/quiz-toolkit",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_label:"Quiz Toolkit",sidebar_position:1},sidebar:"tutorialSidebar",previous:{title:"App Monetization",permalink:"/monetization"},next:{title:"OpenSeesPy",permalink:"/advanced-applications/openseespy"}},c={},d=[{value:"Steps 1: Create your quiz App",id:"steps-1-create-your-quiz-app",level:2},{value:"Steps 2: Store results in Google Sheets",id:"steps-2-store-results-in-google-sheets",level:2},{value:"Arguments:",id:"arguments",level:4},{value:"How to Get Spreadsheet ID",id:"how-to-get-spreadsheet-id",level:3},{value:"How to Get Service Account Info",id:"how-to-get-service-account-info",level:3},{value:"<strong>Step 1: Enable the Google Sheets API</strong>",id:"step-1-enable-the-google-sheets-api",level:4},{value:"<strong>Step 2: Create Service Account Credentials</strong>",id:"step-2-create-service-account-credentials",level:4},{value:"Steps 3: Send email to someone when they submit.",id:"steps-3-send-email-to-someone-when-they-submit",level:2},{value:"Arguments:",id:"arguments-1",level:4},{value:"How to Create a Google App Password",id:"how-to-create-a-google-app-password",level:3}];function a(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(s.h1,{id:"quiz-toolkit",children:"Quiz Toolkit"}),"\n",(0,n.jsx)(s.table,{children:(0,n.jsx)(s.thead,{children:(0,n.jsx)(s.tr,{children:(0,n.jsxs)(s.th,{children:["\ud83c\udfc6"," This is a ",(0,n.jsx)(s.a,{href:"https://mecsimcalc.com/pricing",children:"premium"})," feature"]})})})}),"\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"MecSimCalc"})," now supports online quizzes.\nIn this tutorial, we'll learn how to build a Quiz App for educational purposes. The app displays scores\ninstantly, saves results to ",(0,n.jsx)(s.strong,{children:"Google Sheets"}),", and ",(0,n.jsx)(s.strong,{children:"sends email"})," to students or professors."]}),"\n",(0,n.jsxs)(s.p,{children:["Seamlessly integrates with ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.a,{href:"https://www.google.ca/sheets/about/",children:"Google Sheets"})})," for straightforward and organized data compilation.\n",(0,n.jsx)(s.img,{alt:"img alt",src:t(1807).Z+"",width:"1196",height:"100"})]}),"\n",(0,n.jsxs)(s.p,{children:["Utilizes ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.a,{href:"https://www.google.com/gmail/about/",children:"Gmail"})})," for direct communication and data sharing, ensuring immediate feedback and results dissemination.\n",(0,n.jsx)(s.img,{alt:"img alt",src:t(8856).Z+"",width:"1212",height:"262"})]}),"\n",(0,n.jsx)(s.admonition,{type:"info",children:(0,n.jsxs)(s.p,{children:["You will need to provide additional parameters for these two features. ",(0,n.jsx)(s.strong,{children:"Don't worry, we will teach you how to obtain them later!"})]})}),"\n",(0,n.jsx)(s.h2,{id:"steps-1-create-your-quiz-app",children:"Steps 1: Create your quiz App"}),"\n",(0,n.jsxs)(s.p,{children:["For example, you can get student's ",(0,n.jsx)(s.code,{children:"name"})," and ",(0,n.jsx)(s.code,{children:"id"})," from the input, and calculate ",(0,n.jsx)(s.code,{children:"grade"})," through code. If you want this information to be exported to your own Google Sheet, you can do it like this:"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"\"\"\"\nAssume that inputs['name'] = \"Joe\", inputs['id'] = \"186234\", inputs['grade'] = 85\n\"\"\"\nimport mecsimcalc as msc\n\ndef main(inputs):\n    grade = ... #your logic here\n    \n    #values you want to collect\n    values = [\n    [ inputs['name'], inputs['id'], grade ],\n    ]    \n\n    # For Google Sheet:\n    service_account_info = {\n        # We will teach you how to get this later, don't worry\n    }\n    spreadsheet_id = 'your_spreadsheet_id_here'\n  \n    msc.append_to_google_sheet(service_account_info, spreadsheet_id, values)\n\n    \n    # For Gmail:\n    sender_email = 'sender@example.com'\n    receiver_email = 'receiver@example.com'\n    subject = 'Quiz Results'\n    app_password = 'your_app_password_here'\n    \n    msc.send_gmail(sender_email, receiver_email, subject, app_password, values)\n    ...\n"})}),"\n",(0,n.jsx)(s.h2,{id:"steps-2-store-results-in-google-sheets",children:"Steps 2: Store results in Google Sheets"}),"\n",(0,n.jsxs)(s.p,{children:["MecSimCalc has its own function that can be used.Users can append data to their own Google Sheets by calling ",(0,n.jsx)(s.a,{href:"../mecsimcalc-library#append_to_google_sheet",children:(0,n.jsx)(s.code,{children:"append_to_google_sheet"})}),"."]}),"\n",(0,n.jsx)(s.h4,{id:"arguments",children:"Arguments:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Argument"}),(0,n.jsx)(s.th,{children:"Type"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"service_account_info"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"dict"})}),(0,n.jsx)(s.td,{children:"The credentials used for Google Sheets API authentication."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"spreadsheet_id"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"str"})}),(0,n.jsx)(s.td,{children:"The unique identifier of your Google Spreadsheet."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"values"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"list of lists"})}),(0,n.jsx)(s.td,{children:"The data to append. Each list element represents a row of data."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"range_name"})})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"str"})," (optional)"]}),(0,n.jsx)(s.td,{children:"The A1 notation of the range to start appending data (Defaults to 'Sheet1!A1'). Generally, there is no need to make changes.."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"include_timestamp"})})}),(0,n.jsxs)(s.td,{children:[(0,n.jsx)(s.strong,{children:"bool"})," (optional)"]}),(0,n.jsx)(s.td,{children:"If True, appends the current timestamp to each row of data (Defaults to True)."})]})]})]}),"\n",(0,n.jsx)(s.p,{children:"All you need to do is add:"}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:"values = [\n    [ inputs['name'], inputs['id'], grade ],\n]  \n    \nmsc.append_to_google_sheet(service_account_info, spreadsheet_id, values)\n\n# if you don't want to include timestamp\nmsc.append_to_google_sheet(service_account_info, spreadsheet_id, values, \ninclude_timestamp=False)\n"})}),"\n",(0,n.jsxs)(s.p,{children:["Quiz values will append to your Google Sheet:\n",(0,n.jsx)(s.img,{alt:"img alt",src:t(1807).Z+"",width:"1196",height:"100"})]}),"\n",(0,n.jsxs)(s.p,{children:["In this part, we will teach you how to find the ",(0,n.jsx)(s.code,{children:"spreadsheet_id"})," and ",(0,n.jsx)(s.code,{children:"service_account_info"})," parameters for ",(0,n.jsx)(s.code,{children:"append_to_google_sheet"})," function"]}),"\n",(0,n.jsx)(s.h3,{id:"how-to-get-spreadsheet-id",children:"How to Get Spreadsheet ID"}),"\n",(0,n.jsxs)(s.p,{children:["You need to create a Spreadsheet first.\nThe Spreadsheet ID is\xa0",(0,n.jsx)(s.strong,{children:"the last string of characters in the URL for your spreadsheet"}),"."]}),"\n",(0,n.jsxs)(s.p,{children:["For example, in the URL ",(0,n.jsx)(s.a,{href:"https://docs.google.com/spreadsheets/d/1qpyC0XzvTcKT6wQoFDE8p-Bll4hps/edit#gid=0",children:"https://docs.google.com/spreadsheets/d/1qpyC0XzvTcKT6wQoFDE8p-Bll4hps/edit#gid=0"})," , the spreadsheet ID is ",(0,n.jsx)(s.strong,{children:"1qpyC0XzvTcKT6wQoFDE8p-Bll4hps"})]}),"\n",(0,n.jsx)(s.h3,{id:"how-to-get-service-account-info",children:"How to Get Service Account Info"}),"\n",(0,n.jsx)(s.h4,{id:"step-1-enable-the-google-sheets-api",children:(0,n.jsx)(s.strong,{children:"Step 1: Enable the Google Sheets API"})}),"\n",(0,n.jsx)(s.p,{children:"Before integrating Google APIs into your project, you must enable them within a Google Cloud project. This process allows you to activate one or multiple APIs under the same project umbrella."}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"First"}),", navigate to the Google Cloud Console and activate the Google Sheets API through the following link: ",(0,n.jsx)(s.a,{href:"https://console.cloud.google.com/flows/enableapi?apiid=sheets.googleapis.com",children:"Enable the Google Sheets API"}),"."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"img alt",src:t(2402).Z+"",width:"1704",height:"434"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Next"}),", you'll need to create a Google Cloud Project if you haven't done so already. Detailed instructions can be found here: ",(0,n.jsx)(s.a,{href:"https://developers.google.com/workspace/guides/create-project",children:"Create a Google Cloud Project"}),"."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"img alt",src:t(5579).Z+"",width:"2642",height:"1246"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.h4,{id:"step-2-create-service-account-credentials",children:(0,n.jsxs)(s.strong,{children:["Step 2: ",(0,n.jsx)(s.a,{href:"https://developers.google.com/workspace/guides/create-credentials#create_credentials_for_a_service_account",children:"Create Service Account"})," Credentials"]})}),"\n",(0,n.jsx)(s.p,{children:"To authenticate your application with Google's APIs, follow these steps to create and obtain service account credentials:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["In the Google Cloud console, go to Menu  > ",(0,n.jsx)(s.strong,{children:"IAM & Admin"})," > ",(0,n.jsx)(s.strong,{children:"Service Accounts"}),"."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.a,{href:"https://console.cloud.google.com/iam-admin/serviceaccounts",children:"Go to Service Accounts"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Choose your service account"}),". If you don't have one, create a new service account and assign it the Editor role for adequate permissions."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"img alt",src:t(9712).Z+"",width:"2568",height:"1428"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:["Navigate to ",(0,n.jsx)(s.strong,{children:"Keys"})," > ",(0,n.jsx)(s.strong,{children:"Add Key"})," > ",(0,n.jsx)(s.strong,{children:"Create New Key"}),", and select the ",(0,n.jsx)(s.strong,{children:"JSON"})," option. Upon clicking ",(0,n.jsx)(s.strong,{children:"Create"}),", a JSON file containing your new key pair will be downloaded."]}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"img alt",src:t(9263).Z+"",width:"2622",height:"1510"})}),"\n"]}),"\n",(0,n.jsxs)(s.li,{children:["\n",(0,n.jsxs)(s.p,{children:[(0,n.jsx)(s.strong,{children:"Save the JSON file"})," as ",(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"credentials.json"})})," in your project directory. This file contains your service account's credentials, which you'll use to authenticate your application. Here's what the JSON file looks like:"]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-json",children:'{\n  "type": "service_account",\n  "project_id": "your-project-id",\n  "private_key_id": "private_key_id",\n  "private_key": "-----BEGIN PRIVATE KEY-----\u2026-----END PRIVATE KEY-----\\n",\n  "client_email": "your-service-account-email",\n  "client_id": "your-client-id",\n  "auth_uri": "https://accounts.google.com/o/oauth2/auth",\n  "token_uri": "https://oauth2.googleapis.com/token",\n  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",\n  "client_x509_cert_url": "your-client-x509-cert-url"\n}\n'})}),"\n",(0,n.jsxs)(s.p,{children:["The contents of ",(0,n.jsx)(s.code,{children:"credentials.json"})," will be used as the ",(0,n.jsx)(s.code,{children:"service_account_info"})," parameter. Simply copy this information and pass it to the ",(0,n.jsx)(s.code,{children:"append_to_sheet()"})," function as the ",(0,n.jsx)(s.code,{children:"service_account_info"})," argument."]}),"\n",(0,n.jsx)(s.h2,{id:"steps-3-send-email-to-someone-when-they-submit",children:"Steps 3: Send email to someone when they submit."}),"\n",(0,n.jsxs)(s.p,{children:["You can use ",(0,n.jsx)(s.a,{href:"../mecsimcalc-library#send_gmail",children:(0,n.jsx)(s.code,{children:"send_gmail"})})," function."]}),"\n",(0,n.jsx)(s.h4,{id:"arguments-1",children:"Arguments:"}),"\n",(0,n.jsxs)(s.table,{children:[(0,n.jsx)(s.thead,{children:(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.th,{children:"Argument"}),(0,n.jsx)(s.th,{children:"Type"}),(0,n.jsx)(s.th,{children:"Description"})]})}),(0,n.jsxs)(s.tbody,{children:[(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"sender_email"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"str"})}),(0,n.jsx)(s.td,{children:"The email address of the sender."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"receiver_email"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"str"})}),(0,n.jsx)(s.td,{children:"The email address of the receiver."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"subject"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"str"})}),(0,n.jsx)(s.td,{children:"The subject line of the email."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"app_password"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"str"})}),(0,n.jsx)(s.td,{children:"The app-specific password for the sender's email account."})]}),(0,n.jsxs)(s.tr,{children:[(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:(0,n.jsx)(s.code,{children:"values"})})}),(0,n.jsx)(s.td,{children:(0,n.jsx)(s.strong,{children:"list"})}),(0,n.jsx)(s.td,{children:"A list of lists. Each list contains data to be included in the email body."})]})]})]}),"\n",(0,n.jsxs)(s.p,{children:["For example, you can retrieve the student's ",(0,n.jsx)(s.code,{children:"name"})," and ",(0,n.jsx)(s.code,{children:"id"})," from the input, calculate the ",(0,n.jsx)(s.code,{children:"grade"})," through code, and this information can be sent to the receiver's email. All you need to do is add :"]}),"\n",(0,n.jsx)(s.pre,{children:(0,n.jsx)(s.code,{className:"language-python",children:'values = [\n        ["Joe", "186234", 85]\n]\nmsc.send_email(sender_email = "sender_email@gmail.com", \n               receiver_email = "receiver_email@example.ca", \n               subject = "Quiz Results", \n               app_password = "xxxx xxxx xxxx xxxx", \n               values = values)\n'})}),"\n",(0,n.jsx)(s.p,{children:"Then receiver will get an email like this:"}),"\n",(0,n.jsx)(s.p,{children:(0,n.jsx)(s.img,{alt:"img alt",src:t(8856).Z+"",width:"1212",height:"262"})}),"\n",(0,n.jsxs)(s.p,{children:["In this part, we will teach you how to find the ",(0,n.jsx)(s.code,{children:"app_password"})," parameter for ",(0,n.jsx)(s.code,{children:"send_gmail"})," function"]}),"\n",(0,n.jsx)(s.h3,{id:"how-to-create-a-google-app-password",children:"How to Create a Google App Password"}),"\n",(0,n.jsxs)(s.p,{children:["Official Google support page: ",(0,n.jsx)(s.a,{href:"https://support.google.com/accounts/answer/185833?hl=en",children:"Create & use App Passwords"}),"."]}),"\n",(0,n.jsx)(s.p,{children:"An app password is a 16-digit code that allows less secure apps or devices to access your Google Account. This is especially useful if you have 2-Step Verification enabled and the app you're using doesn't support \"Sign in with Google.\" Here\u2019s how to create one:"}),"\n",(0,n.jsxs)(s.ol,{children:["\n",(0,n.jsxs)(s.li,{children:["Go to your\xa0",(0,n.jsx)(s.a,{href:"https://myaccount.google.com/",children:"Google Account"}),"."]}),"\n",(0,n.jsxs)(s.li,{children:["Select\xa0",(0,n.jsx)(s.strong,{children:"Security."})]}),"\n",(0,n.jsxs)(s.li,{children:['Under "Signing in to Google," select\xa0',(0,n.jsx)(s.strong,{children:"2-Step Verification"}),".\n",(0,n.jsx)(s.img,{alt:"img alt",src:t(6434).Z+"",width:"2476",height:"528"})]}),"\n",(0,n.jsxs)(s.li,{children:["At the bottom of the page, select\xa0",(0,n.jsx)(s.strong,{children:"App passwords"}),"."]}),"\n",(0,n.jsx)(s.li,{children:"Enter a name that helps you remember where you\u2019ll use the app password."}),"\n",(0,n.jsxs)(s.li,{children:["Click ",(0,n.jsx)(s.strong,{children:"Generate"})," to obtain the 16-digit app password."]}),"\n",(0,n.jsxs)(s.li,{children:[(0,n.jsx)(s.strong,{children:"Make sure to save the app password"})," (as you won't be able to see it later) and then copy it into your quiz app"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.a)(),...e.components};return s?(0,n.jsx)(s,{...e,children:(0,n.jsx)(a,{...e})}):a(e)}},8856:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/gmail_ex-9df9a6dc3318de8b29174e6e5f54195d.png"},6434:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/gmail_step_1-a2a7090dae865b80bb70fd946a93ffc1.png"},1807:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/sheet_ex-ff85891e2850a2b5d672aed4dfc33603.png"},2402:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/sheet_step_1-66eedbb7521b1b2133fcddb4eb0d27fb.png"},5579:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/sheet_step_2-0a1c381072b5d638b1f9386ba648f01d.png"},9712:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/sheet_step_3-47fe65e827c7a8e187e9723ce6e34f97.png"},9263:(e,s,t)=>{t.d(s,{Z:()=>n});const n=t.p+"assets/images/sheet_step_4-b58776b11362568118ec820d9a773338.png"},1151:(e,s,t)=>{t.d(s,{Z:()=>l,a:()=>r});var n=t(7294);const i={},o=n.createContext(i);function r(e){const s=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),n.createElement(o.Provider,{value:s},e.children)}}}]);