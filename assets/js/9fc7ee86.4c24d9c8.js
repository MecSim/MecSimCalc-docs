"use strict";(self.webpackChunkmec_sim_calc_docs=self.webpackChunkmec_sim_calc_docs||[]).push([[17],{3905:function(e,t,n){n.d(t,{Zo:function(){return l},kt:function(){return u}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),p=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=p(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),m=p(n),u=r,f=m["".concat(d,".").concat(u)]||m[u]||c[u]||i;return n?a.createElement(f,o(o({ref:t},l),{},{components:n})):a.createElement(f,o({ref:t},l))}));function u(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=m;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:r,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7442:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return s},contentTitle:function(){return d},metadata:function(){return p},toc:function(){return l},default:function(){return m}});var a=n(7462),r=n(3366),i=(n(7294),n(3905)),o=["components"],s={sidebar_label:"Files",sidebar_position:2},d="Files",p={unversionedId:"Objects/files",id:"Objects/files",title:"Files",description:"File Input",source:"@site/docs/Objects/files.md",sourceDirName:"Objects",slug:"/Objects/files",permalink:"/Objects/files",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_label:"Files",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/Objects/Overview"},next:{title:"Text Files",permalink:"/Objects/TextFiles"}},l=[{value:"File Input",id:"file-input",children:[],level:2},{value:"Decoding File Data",id:"decoding-file-data",children:[],level:2},{value:"File Output",id:"file-output",children:[],level:2}],c={toc:l};function m(e){var t=e.components,n=(0,r.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"files"},"Files"),(0,i.kt)("h2",{id:"file-input"},"File Input"),(0,i.kt)("p",null,"As described in the ",(0,i.kt)("a",{parentName:"p",href:"../Inputs/Input-Types"},"input types page"),", the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"developer"))," can chose ",(0,i.kt)("inlineCode",{parentName:"p"},"FileInput")," when creating the inputs page of an ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"app"))," allowing the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"user"))," to upload files whose data can be used within the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"app")),". When a file is imported, ",(0,i.kt)("strong",{parentName:"p"},"MecsimCalc")," platform converts its data into a ",(0,i.kt)("a",{parentName:"p",href:"https://stackoverflow.com/questions/3538021"},"base64")," string that contains the file data preceded by the data type and the encoding. For example, the resulting string of imported CSV and PNG files have the following respective forms:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'"data:text/csv;base64,xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\n"data:image/png;base64,xxxxxxxxxxxxxxxxxxxxxxxxxxxxx"\n')),(0,i.kt)("p",null,"where ",(0,i.kt)("inlineCode",{parentName:"p"},"xxxxxxxxxxxxxxxxxxxxxxxxxxxxx")," is the base64 string encoding of the file data."),(0,i.kt)("p",null,"As an example, the ",(0,i.kt)("a",{parentName:"p",href:"https://mecsimcalc.com/app/3705244/import_file"},"File Import ",(0,i.kt)("em",{parentName:"a"},(0,i.kt)("strong",{parentName:"em"},"app")))," imports a file and displays the the file type and the corresponding base64 string. Part of the code for this ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"app"))," is given below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'def main(inputs):\n    [meta, data] = inputs[\'file\'].split(";base64,")\n    metadata = meta + ";base64,"\n\n    return {\n        "MetaData":metadata,\n        "Base64 String": data\n    }\n')),(0,i.kt)("p",null,"The two keys ",(0,i.kt)("inlineCode",{parentName:"p"},"MetaData")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Base64 String")," are then used in the output page to display their values:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'File Type: {{outputs.MetaData}}\nBase64 String: {{ outputs["Base64 String"] }}\n')),(0,i.kt)("h2",{id:"decoding-file-data"},"Decoding File Data"),(0,i.kt)("p",null,"Once file data is uploaded, the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"developer"))," can use the ",(0,i.kt)("inlineCode",{parentName:"p"},"base64")," python library to decode and manipulate the data. The ",(0,i.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/base64.html"},(0,i.kt)("inlineCode",{parentName:"a"},"base64.b64decode()"))," function can be used to convert the data into a ",(0,i.kt)("a",{parentName:"p",href:"https://docs.python.org/3/library/stdtypes.html#bytes"},(0,i.kt)("inlineCode",{parentName:"a"},"Bytes Object")),". As an example, the following code returns the file type, the base64 string representation of the data, and the decoded ",(0,i.kt)("inlineCode",{parentName:"p"},"Bytes")," data."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'import base64\n\ndef main(inputs):\n    # Decode the file data\n    [meta, data] = inputs[\'file\'].split(";base64,")\n    metadata = meta + ";base64,"\n    decodeddata=base64.b64decode(data)\n    return {\n        "MetaData":metadata,\n        "Base64 String": data,\n        "decoded String":decodeddata\n    }\n')),(0,i.kt)("h2",{id:"file-output"},"File Output"),(0,i.kt)("p",null,"In order to create and export a file for the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"user"))," to download, the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"developer"))," can use base64 encoding for data transfer.The function ",(0,i.kt)("inlineCode",{parentName:"p"},"base64.b64encode()")," can convert ",(0,i.kt)("inlineCode",{parentName:"p"},"Bytes")," data into base64 encoded bytes. Then, the ",(0,i.kt)("inlineCode",{parentName:"p"},".decode()")," method can prepare the bytes data for download. The file type data should be added to the beginning of the file and the resulting string can then be prepared for download using the ",(0,i.kt)("inlineCode",{parentName:"p"},"<a>")," HTML tag."),(0,i.kt)("p",null,"The following code which is implemented in the ",(0,i.kt)("a",{parentName:"p",href:"https://mecsimcalc.com/app/3705244/import_file"},"import file published demonstration")," ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"app"))," uses data obtained from a file uploaded by the ",(0,i.kt)("em",{parentName:"p"},(0,i.kt)("strong",{parentName:"em"},"user")),". The file extension is obtained using the ",(0,i.kt)("inlineCode",{parentName:"p"},"guess_extension")," function available through the ",(0,i.kt)("inlineCode",{parentName:"p"},"mimetypes")," library. The code creates two file data that are then available for download. The first file is prepared using the original data while the second file is prepared by first decoding the original data and then encoding it again. The extension of the second file in the download link is set to ",(0,i.kt)("inlineCode",{parentName:"p"},".txt"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-python"},'from mimetypes import guess_extension, guess_type\nimport base64\n\ndef main(inputs):\n    #Split the file data into two components meta and data. The split function removes the string ";base64",\n    [meta, data] = inputs[\'file\'].split(";base64,")\n\n    #add ";base64" to meta\n    metadata = meta + ";base64,"\n    #recreate the original file data by concatenating metadata and data\n    OriginalFile=metadata+data\n\n    #create a byte_object by decoding the file data\n    byte_object=base64.b64decode(data)\n    #create a string of the decoded byte_object using the .decode() method.\n    decoded_string_object=0#byte_object.decode()\n    #using base64, the byte object can be encoded resulting in a byte object. The ".decode()" method returns the equivalent string.\n    base64_converted_string=base64.b64encode(byte_object).decode()\n    #creates a new file by concatenating metadata and the base64_converted_string\n    NewFile=metadata+base64_converted_string\n\n    #guess the extension from meta\n    file_extension1=guess_extension(guess_type(metadata)[0])\n    # new file extension\n    file_extension2=".txt"\n\n    return {\n        "MetaData":metadata,\n        "Base64 String": data,\n        "decoded Bytes":byte_object,\n        "decoded String Object":decoded_string_object,\n        "Download Original": "<a href=\'" +OriginalFile+ "\' download=\'Original" + file_extension1 + "\'>Download</a>",\n        "Download New": "<a href=\'" +NewFile+ "\' download=\'New" + file_extension2 + "\'>Download</a>"\n    }\n')),(0,i.kt)("p",null,"Notice that the values of the ",(0,i.kt)("inlineCode",{parentName:"p"},"Download Original")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Download New")," dictionary keys are given in string format with html The output has the form:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'To download original file: {{ outputs["Download Original"] }}\nTo download new file (with extension .txt): {{ outputs["Download New"] }}\n\nFile Type: {{outputs.MetaData}}\nBase64 String: {{ outputs["Base64 String"] }}\nDecoded Bytes Object: {{ outputs["decoded Bytes"] }}\n')))}m.isMDXComponent=!0}}]);